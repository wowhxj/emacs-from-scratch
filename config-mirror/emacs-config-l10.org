#+TITLE: Emacsé…ç½®æ–‡ä»¶
#+SUBTITLE: é¢å‘äº§å“ç»ç†çš„Emacsæ•™ç¨‹
#+AUTHOR: Randolph
#+DATE: 2022/12/22 14:23:50

#+STARTUP: overview

* early-init.el
:PROPERTIES:
:HEADER-ARGS: :tangle early-init.el
:END:

åœ¨Emacsåˆšå¯åŠ¨ï¼Œè¿˜æœªåŠ è½½ä¸»è¦é…ç½®æ–‡ä»¶æ—¶çš„é…ç½®æ–‡ä»¶ã€‚

#+BEGIN_SRC emacs-lisp
;;; early-init.el --- Emacs pre-initialization config -*- lexical-binding: t -*-
;;; Commentary:

;;; Code:

;; è®¾ç½®åƒåœ¾å›æ”¶å‚æ•°
(setq gc-cons-threshold most-positive-fixnum)
(setq gc-cons-percentage 0.6)

;; å¯åŠ¨æ—©æœŸä¸åŠ è½½`package.el'åŒ…ç®¡ç†å™¨
(setq package-enable-at-startup nil)
;; ä¸ä»åŒ…ç¼“å­˜ä¸­åŠ è½½
(setq package-quickstart nil)

;; ç¦æ­¢å±•ç¤ºèœå•æ ã€å·¥å…·æ å’Œçºµå‘æ»šåŠ¨æ¡
(push '(menu-bar-lines . 0) default-frame-alist)
(push '(tool-bar-lines . 0) default-frame-alist)
(push '(vertical-scroll-bars) default-frame-alist)

;; ç¦æ­¢è‡ªåŠ¨ç¼©æ”¾çª—å£å…ˆ
(setq frame-inhibit-implied-resize t)

;; ç¦æ­¢èœå•æ ã€å·¥å…·æ ã€æ»šåŠ¨æ¡æ¨¡å¼ï¼Œç¦æ­¢å¯åŠ¨å±å¹•å’Œæ–‡ä»¶å¯¹è¯æ¡†
(menu-bar-mode -1)
(tool-bar-mode -1)
(scroll-bar-mode -1)
(setq inhibit-splash-screen t)
(setq use-file-dialog nil)

;; åœ¨è¿™ä¸ªé˜¶æ®µä¸ç¼–è¯‘
(setq comp-deferred-compilation nil)

(provide 'early-init)
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;; early-init.el ends here
#+END_SRC

* init.el
:PROPERTIES:
:HEADER-ARGS: :tangle init.el
:END:

=init.el= æ˜¯Emacsçš„ä¸»è¦é…ç½®æ–‡ä»¶ã€‚

** init.el æ–‡ä»¶å¤´
#+BEGIN_SRC emacs-lisp
;;; init.el --- The main init entry for Emacs -*- lexical-binding: t -*-
;;; Commentary:

;;; Code:

#+END_SRC

** packageåŒ…ç®¡ç†é…ç½®
#+begin_src emacs-lisp
(require 'package)
(setq package-archives
	  '(("melpa"  . "https://melpa.org/packages/")
	    ("gnu"    . "https://elpa.gnu.org/packages/")
	    ("nongnu" . "https://elpa.nongnu.org/nongnu/")))

(package-initialize)
#+end_src

** å®‰è£…use-packageæ’ä»¶
[[https://github.com/jwiegley/use-package][use-package]] æ˜¯ä¸€ä¸ªè®©Emacsé…ç½®æ›´åŠ ç»“æ„åŒ–æ›´åŠ æ¸…æ™°çš„ä¸€ä¸ªå®æ’ä»¶ã€‚

#+begin_src emacs-lisp
;; å®‰è£… `use-package'
(unless (package-installed-p 'use-package)
  (package-refresh-contents)
  (package-install 'use-package))

;; é…ç½® `use-package'
(eval-and-compile
  (setq use-package-always-ensure nil)
  (setq use-package-always-defer nil)
  (setq use-package-expand-minimally nil)
  (setq use-package-enable-imenu-support t)
  (if (daemonp)
	  (setq use-package-always-demand t)))

(eval-when-compile
  (require 'use-package))

;; å®‰è£… `use-package' çš„é›†æˆæ¨¡å—
(use-package use-package-ensure-system-package
  :ensure t)
(use-package diminish
  :ensure t)
(use-package bind-key
  :ensure t)
#+end_src

** quelpaåŒ…ç®¡ç†å™¨
[[https://github.com/quelpa/quelpa][quelpa]] æ˜¯é…åˆ =package.el= ä½¿ç”¨çš„ï¼ŒåŸºäºgitçš„ä¸€ä¸ªåŒ…ç®¡ç†å™¨ã€‚
#+BEGIN_SRC emacs-lisp
;; å®‰è£… `quelpa'
(use-package quelpa
  :ensure t
  :commands quelpa
  :config
  :custom
  (quelpa-git-clone-depth 1)
  (quelpa-update-melpa-p nil)
  (quelpa-self-upgrade-p nil)
  (quelpa-checkout-melpa-p nil))

;; `quelpa' ä¸ `use-package' é›†æˆ
(use-package quelpa-use-package
  :ensure t)
#+END_SRC

** åŠ è½½æ¨¡å—åŒ–é…ç½®

#+BEGIN_SRC emacs-lisp
  ;; å°†lispç›®å½•æ”¾åˆ°åŠ è½½è·¯å¾„çš„å‰é¢ä»¥åŠ å¿«å¯åŠ¨é€Ÿåº¦
  (let ((dir (locate-user-emacs-file "lisp")))
    (add-to-list 'load-path (file-name-as-directory dir)))

  ;; åŠ è½½å„æ¨¡å—åŒ–é…ç½®
  ;; ä¸è¦åœ¨`*message*'ç¼“å†²åŒºæ˜¾ç¤ºåŠ è½½æ¨¡å—åŒ–é…ç½®çš„ä¿¡æ¯
  (with-temp-message ""
    (require 'init-ui)                    ; UIäº¤äº’
    (require 'init-edit)                  ; ç¼–è¾‘è¡Œä¸º
    (require 'init-org)                   ; orgç›¸å…³è®¾ç½®
    (require 'init-completion)            ; è¡¥å…¨ç³»ç»Ÿ
    (require 'init-tools)                 ; ç›¸å…³å·¥å…·
    )
#+END_SRC

** init.el æ–‡ä»¶å°¾
#+BEGIN_SRC emacs-lisp

(provide 'init)
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;; init.el ends here
#+END_SRC

* init-ui.el
:PROPERTIES:
:HEADER-ARGS: :tangle lisp/init-ui.el :mkdirp yes
:END:

** init-ui.el æ–‡ä»¶å¤´
#+BEGIN_SRC emacs-lisp
;;; init-ui.el --- UI settings -*- lexical-binding: t -*-
;;; Commentary:

;;; Code:

#+END_SRC

** efä¸»é¢˜

[[https://protesilaos.com/emacs/ef-themes][ef themes]] æ˜¯æˆ‘éå¸¸å–œæ¬¢çš„ä¸€ä¸ªä¸»é¢˜åŒ…ã€‚

#+BEGIN_SRC emacs-lisp
(use-package ef-themes
  :ensure t
  :bind ("C-c t" . ef-themes-toggle)
  :init
  ;; set two specific themes and switch between them
  (setq ef-themes-to-toggle '(ef-summer ef-winter))
  ;; set org headings and function syntax
  (setq ef-themes-headings
        '((0 . (bold 1))
          (1 . (bold 1))
          (2 . (rainbow bold 1))
          (3 . (rainbow bold 1))
          (4 . (rainbow bold 1))
          (t . (rainbow bold 1))))
  (setq ef-themes-region '(intense no-extend neutral))
  ;; Disable all other themes to avoid awkward blending:
  (mapc #'disable-theme custom-enabled-themes)

  ;; Load the theme of choice:
  ;; The themes we provide are recorded in the `ef-themes-dark-themes',
  ;; `ef-themes-light-themes'.
  
  ;; å¦‚æœä½ ä¸å–œæ¬¢éšæœºä¸»é¢˜ï¼Œä¹Ÿå¯ä»¥ç›´æ¥å›ºå®šé€‰æ‹©ä¸€ä¸ªä¸»é¢˜ï¼Œå¦‚ä¸‹ï¼š
  ;; (ef-themes-select 'ef-summer)

  ;; éšæœºæŒ‘é€‰ä¸€æ¬¾ä¸»é¢˜ï¼Œå¦‚æœæ˜¯å‘½ä»¤è¡Œæ‰“å¼€Emacsï¼Œåˆ™éšæœºæŒ‘é€‰ä¸€æ¬¾é»‘è‰²ä¸»é¢˜
  (if (display-graphic-p)
      (ef-themes-load-random)
    (ef-themes-load-random 'dark))

  :config
  ;; auto change theme, aligning with system themes.
  (defun my/apply-theme (appearance)
    "Load theme, taking current system APPEARANCE into consideration."
    (mapc #'disable-theme custom-enabled-themes)
    (pcase appearance
      ('light (if (display-graphic-p) (ef-themes-load-random 'light) (ef-themes-load-random 'dark)))
      ('dark (ef-themes-load-random 'dark))))

  (if (eq system-type 'darwin)
      ;; only for emacs-plus
      (add-hook 'ns-system-appearance-change-functions #'my/apply-theme)
    (ef-themes-select 'ef-summer)
    )
  )
#+END_SRC

** å­—ä½“è®¾ç½®

[[https://protesilaos.com/emacs/fontaine][fontaine]] æ’ä»¶å¯ä»¥æ ¹æ®éœ€è¦é«˜åº¦å®šåˆ¶å­—ä½“ã€‚

#+BEGIN_QUOTE
è¿™ç¯‡æ–‡ç« å¯ä»¥ä½œä¸ºå­—ä½“è®¾ç½®çš„å‚è€ƒï¼š
[[http://xahlee.info/emacs/emacs/emacs_list_and_set_font.html]]
#+END_QUOTE

#+BEGIN_SRC emacs-lisp
(use-package fontaine
  :ensure t
  :when (display-graphic-p)
  ;; :hook (kill-emacs . fontaine-store-latest-preset)
  :config
  (setq fontaine-latest-state-file
        (locate-user-emacs-file "etc/fontaine-latest-state.eld"))
  (setq fontaine-presets
        '((regular
           :default-height 140
           :default-weight regular
           :fixed-pitch-height 1.0
           :variable-pitch-height 1.0
           )
          (large
           :default-height 180
           :default-weight normal
           :fixed-pitch-height 1.0
           :variable-pitch-height 1.05
           )
          (t
           :default-family "Source Code Pro"
           :fixed-pitch-family "Source Code Pro"
           :variable-pitch-family "Source Code Pro"
           :italic-family "Source Code Pro"
           :variable-pitch-weight normal
           :bold-weight normal
           :italic-slant italic
           :line-spacing 0.1)
          ))
  ;; (fontaine-set-preset (or (fontaine-restore-latest-preset) 'regular))
  (fontaine-set-preset 'regular)

  ;; set emoji font
  (set-fontset-font
   t
   (if (version< emacs-version "28.1")
       '(#x1f300 . #x1fad0)
     'emoji)
   (cond
    ((member "Noto Emoji" (font-family-list)) "Noto Emoji")
    ((member "Symbola" (font-family-list)) "Symbola")
    ((member "Apple Color Emoji" (font-family-list)) "Apple Color Emoji")
    ((member "Noto Color Emoji" (font-family-list)) "Noto Color Emoji")
    ((member "Segoe UI Emoji" (font-family-list)) "Segoe UI Emoji")
    ))

  ;; set Chinese font
  (dolist (charset '(kana han symbol cjk-misc bopomofo))
    (set-fontset-font
     (frame-parameter nil 'font)
     charset
     (font-spec :family
                (cond
                 ((eq system-type 'darwin)
                  (cond
                   ((member "Sarasa Mono SC Nerd" (font-family-list)) "Sarasa Mono SC Nerd")
                   ((member "PingFang SC" (font-family-list)) "PingFang SC")
                   ((member "WenQuanYi Zen Hei" (font-family-list)) "WenQuanYi Zen Hei")
                   ((member "Microsoft YaHei" (font-family-list)) "Microsoft YaHei")
                   ))
                 ((eq system-type 'gnu/linux)
                  (cond
                   ((member "Sarasa Mono SC Nerd" (font-family-list)) "Sarasa Mono SC Nerd")
                   ((member "WenQuanYi Micro Hei" (font-family-list)) "WenQuanYi Micro Hei")
                   ((member "WenQuanYi Zen Hei" (font-family-list)) "WenQuanYi Zen Hei")
                   ((member "Microsoft YaHei" (font-family-list)) "Microsoft YaHei")
                   ))
                 (t
                  (cond
                   ((member "Sarasa Mono SC Nerd" (font-family-list)) "Sarasa Mono SC Nerd")
                   ((member "Microsoft YaHei" (font-family-list)) "Microsoft YaHei")
                   )))
                )))

  ;; set Chinese font scale
  (setq face-font-rescale-alist `(
                                  ("Symbola"             . 1.3)
                                  ("Microsoft YaHei"     . 1.2)
                                  ("WenQuanYi Zen Hei"   . 1.2)
                                  ("Sarasa Mono SC Nerd" . 1.2)
                                  ("PingFang SC"         . 1.16)
                                  ("Lantinghei SC"       . 1.16)
                                  ("Kaiti SC"            . 1.16)
                                  ("Yuanti SC"           . 1.16)
                                  ("Apple Color Emoji"   . 0.91)
                                  ))
  )
#+END_SRC

#+CAPTION: æµ‹è¯•ä¸­è‹±æ–‡å­—ä½“å¯¹é½
#+NAME: æµ‹è¯•ä¸­è‹±æ–‡å­—ä½“å¯¹é½
| ä¸­æ–‡ |   |
| abcd |   |

** çª—å£è®¾ç½®
*** è°ƒæ•´å¯åŠ¨çª—å£å¤§å°
åœ¨Macä¸‹ï¼Œæˆ‘çš„é»˜è®¤å¯åŠ¨çª—å£å¤§å°
#+BEGIN_SRC emacs-lisp
;; è®¾ç½®çª—å£å¤§å°ï¼Œä»…ä»…åœ¨å›¾å½¢ç•Œé¢éœ€è¦è®¾ç½®
(when (display-graphic-p)
  (let ((top    0)                                     ; é¡¶ä¸ç•™ç©º
        (left   (/ (x-display-pixel-width) 10))        ; å·¦è¾¹ç©º10%
        (height (round (* 0.8                          ; çª—ä½“é«˜åº¦ä¸º0.8å€çš„æ˜¾ç¤ºé«˜åº¦
                          (/ (x-display-pixel-height)
                             (frame-char-height))))))
    (let ((width  (round (* 2.5 height))))             ; çª—ä½“å®½åº¦ä¸º2.5å€é«˜åº¦
      (setq default-frame-alist nil)
      (add-to-list 'default-frame-alist (cons 'top top))
      (add-to-list 'default-frame-alist (cons 'left left))
      (add-to-list 'default-frame-alist (cons 'height height))
      (add-to-list 'default-frame-alist (cons 'width width)))))
#+END_SRC

** å…¶ä»–UIé›¶æ•£è®¾ç½®é¡¹

#+begin_src emacs-lisp
;; ç¦ç”¨ä¸€äº›GUIç‰¹æ€§
(setq use-dialog-box nil)               ; é¼ æ ‡æ“ä½œä¸ä½¿ç”¨å¯¹è¯æ¡†
(setq inhibit-default-init t)           ; ä¸åŠ è½½ `default' åº“
(setq inhibit-startup-screen t)         ; ä¸åŠ è½½å¯åŠ¨ç”»é¢
(setq inhibit-startup-message t)        ; ä¸åŠ è½½å¯åŠ¨æ¶ˆæ¯
(setq inhibit-startup-buffer-menu t)    ; ä¸æ˜¾ç¤ºç¼“å†²åŒºåˆ—è¡¨

;; è‰ç¨¿ç¼“å†²åŒºé»˜è®¤æ–‡å­—è®¾ç½®
(setq initial-scratch-message (concat ";; Happy hacking, "
                                      (capitalize user-login-name) " - Emacs â™¥ you!\n\n"))

;; è®¾ç½®ç¼“å†²åŒºçš„æ–‡å­—æ–¹å‘ä¸ºä»å·¦åˆ°å³
(setq bidi-paragraph-direction 'left-to-right)
;; ç¦æ­¢ä½¿ç”¨åŒå‘æ‹¬å·ç®—æ³•
;; (setq bidi-inhibit-bpa t)

;; è®¾ç½®è‡ªåŠ¨æŠ˜è¡Œå®½åº¦ä¸º80ä¸ªå­—ç¬¦ï¼Œé»˜è®¤å€¼ä¸º70
(setq-default fill-column 80)

;; è®¾ç½®å¤§æ–‡ä»¶é˜ˆå€¼ä¸º100MBï¼Œé»˜è®¤10MB
(setq large-file-warning-threshold 100000000)

;; ä»¥16è¿›åˆ¶æ˜¾ç¤ºå­—èŠ‚æ•°
(setq display-raw-bytes-as-hex t)
;; æœ‰è¾“å…¥æ—¶ç¦æ­¢ `fontification' ç›¸å…³çš„å‡½æ•°é’©å­ï¼Œèƒ½è®©æ»šåŠ¨æ›´é¡ºæ»‘
(setq redisplay-skip-fontification-on-input t)

;; ç¦æ­¢å“é“ƒ
(setq ring-bell-function 'ignore)

;; ç¦æ­¢é—ªçƒå…‰æ ‡
(blink-cursor-mode -1)

;; åœ¨å…‰æ ‡å¤„è€Œéé¼ æ ‡æ‰€åœ¨ä½ç½®ç²˜è´´
(setq mouse-yank-at-point t)

;; æ‹·è´ç²˜è´´è®¾ç½®
(setq select-enable-primary nil)        ; é€‰æ‹©æ–‡å­—æ—¶ä¸æ‹·è´
(setq select-enable-clipboard t)        ; æ‹·è´æ—¶ä½¿ç”¨å‰ªè´´æ¿

;; é¼ æ ‡æ»šåŠ¨è®¾ç½®
(setq scroll-step 2)
(setq scroll-margin 2)
(setq hscroll-step 2)
(setq hscroll-margin 2)
(setq scroll-conservatively 101)
(setq scroll-up-aggressively 0.01)
(setq scroll-down-aggressively 0.01)
(setq scroll-preserve-screen-position 'always)

;; å¯¹äºé«˜çš„è¡Œç¦æ­¢è‡ªåŠ¨å‚ç›´æ»šåŠ¨
(setq auto-window-vscroll nil)

;; è®¾ç½®æ–°åˆ†å±æ‰“å¼€çš„ä½ç½®çš„é˜ˆå€¼
(setq split-width-threshold (assoc-default 'width default-frame-alist))
(setq split-height-threshold nil)

;; TABé”®è®¾ç½®ï¼Œåœ¨Emacsé‡Œä¸ä½¿ç”¨TABé”®ï¼Œæ‰€æœ‰çš„TABé»˜è®¤ä¸º4ä¸ªç©ºæ ¼
(setq-default indent-tabs-mode nil)
(setq-default tab-width 4)

;; yesæˆ–noæç¤ºè®¾ç½®ï¼Œé€šè¿‡ä¸‹é¢è¿™ä¸ªå‡½æ•°è®¾ç½®å½“ç¼“å†²åŒºåå­—åŒ¹é…åˆ°é¢„è®¾çš„å­—ç¬¦ä¸²æ—¶è‡ªåŠ¨å›ç­”yes
(setq original-y-or-n-p 'y-or-n-p)
(defalias 'original-y-or-n-p (symbol-function 'y-or-n-p))
(defun default-yes-sometimes (prompt)
  "automatically say y when buffer name match following string"
  (if (or
	   (string-match "has a running process" prompt)
	   (string-match "does not exist; create" prompt)
	   (string-match "modified; kill anyway" prompt)
	   (string-match "Delete buffer using" prompt)
	   (string-match "Kill buffer of" prompt)
	   (string-match "still connected.  Kill it?" prompt)
	   (string-match "Shutdown the client's kernel" prompt)
	   (string-match "kill them and exit anyway" prompt)
	   (string-match "Revert buffer from file" prompt)
	   (string-match "Kill Dired buffer of" prompt)
	   (string-match "delete buffer using" prompt)
       (string-match "Kill all pass entry" prompt)
       (string-match "for all cursors" prompt)
	   (string-match "Do you want edit the entry" prompt))
	  t
    (original-y-or-n-p prompt)))
(defalias 'yes-or-no-p 'default-yes-sometimes)
(defalias 'y-or-n-p 'default-yes-sometimes)

;; è®¾ç½®å‰ªè´´æ¿å†å²é•¿åº¦300ï¼Œé»˜è®¤ä¸º60
(setq kill-ring-max 200)

;; åœ¨å‰ªè´´æ¿é‡Œä¸å­˜å‚¨é‡å¤å†…å®¹
(setq kill-do-not-save-duplicates t)

;; è®¾ç½®ä½ç½®è®°å½•é•¿åº¦ä¸º6ï¼Œé»˜è®¤ä¸º16
;; å¯ä»¥ä½¿ç”¨ `counsel-mark-ring' or `consult-mark' (C-x j) æ¥è®¿é—®å…‰æ ‡ä½ç½®è®°å½•
;; ä½¿ç”¨ C-x C-SPC æ‰§è¡Œ `pop-global-mark' ç›´æ¥è·³è½¬åˆ°ä¸Šä¸€ä¸ªå…¨å±€ä½ç½®å¤„
;; ä½¿ç”¨ C-u C-SPC è·³è½¬åˆ°æœ¬åœ°ä½ç½®å¤„
(setq mark-ring-max 6)
(setq global-mark-ring-max 6)

;; è®¾ç½® emacs-lisp çš„é™åˆ¶
(setq max-lisp-eval-depth 10000)        ; é»˜è®¤å€¼ä¸º 800
(setq max-specpdl-size 10000)           ; é»˜è®¤å€¼ä¸º 1600

;; å¯ç”¨ `list-timers', `list-threads' è¿™ä¸¤ä¸ªå‘½ä»¤
(put 'list-timers 'disabled nil)
(put 'list-threads 'disabled nil)

;; åœ¨å‘½ä»¤è¡Œé‡Œæ”¯æŒé¼ æ ‡
(xterm-mouse-mode 1)

;; é€€å‡ºEmacsæ—¶è¿›è¡Œç¡®è®¤
(setq confirm-kill-emacs 'y-or-n-p)

;; åœ¨æ¨¡å¼æ ä¸Šæ˜¾ç¤ºå½“å‰å…‰æ ‡çš„åˆ—å·
(column-number-mode t)
#+end_src

** ç¼–ç è®¾ç½®

ç»Ÿä¸€ä½¿ç”¨ UTF-8 ç¼–ç ã€‚

#+begin_src emacs-lisp
;; é…ç½®æ‰€æœ‰çš„ç¼–ç ä¸ºUTF-8ï¼Œå‚è€ƒï¼š
;; https://thraxys.wordpress.com/2016/01/13/utf-8-in-emacs-everywhere-forever/
(setq locale-coding-system 'utf-8)
(set-terminal-coding-system 'utf-8)
(set-keyboard-coding-system 'utf-8)
(set-selection-coding-system 'utf-8)
(set-default-coding-systems 'utf-8)
(set-language-environment 'utf-8)
(set-clipboard-coding-system 'utf-8)
(set-file-name-coding-system 'utf-8)
(set-buffer-file-coding-system 'utf-8)
(prefer-coding-system 'utf-8)
(modify-coding-system-alist 'process "*" 'utf-8)
(when (display-graphic-p)
  (setq x-select-request-type '(UTF8_STRING COMPOUND_TEXT TEXT STRING)))
#+end_src

** æ¨¡å¼æ è®¾ç½®
*** doom-modelineæ’ä»¶

[[https://github.com/seagle0128/doom-modeline][doom-modeline]] æ˜¯ä¸€ä¸ªæ¨¡å¼æ ç¾åŒ–æ’ä»¶ã€‚

#+begin_src emacs-lisp
(use-package doom-modeline
  :ensure t
  :hook (after-init . doom-modeline-mode)
  :custom
  (doom-modeline-irc nil)
  (doom-modeline-mu4e nil)
  (doom-modeline-gnus nil)
  (doom-modeline-github nil)
  (doom-modeline-buffer-file-name-style 'truncate-upto-root) ; : auto
  (doom-modeline-persp-name nil)
  (doom-modeline-unicode-fallback t)
  (doom-modeline-enable-word-count nil))
#+end_src

*** minionsæ’ä»¶
[[https://github.com/tarsius/minions][minions]] æ’ä»¶èƒ½è®©æ¨¡å¼æ å˜å¾—æ¸…çˆ½ï¼Œå°†æ¬¡è¦æ¨¡å¼éšè—èµ·æ¥ã€‚

#+BEGIN_SRC emacs-lisp
(use-package minions
  :ensure t
  :hook (after-init . minions-mode))
#+END_SRC

*** keycastæŒ‰é”®å±•ç¤º
[[https://github.com/tarsius/keycast][keycast mode]] æ’ä»¶å¯ä»¥åœ¨æ¨¡å¼æ ä¸Šå±•ç¤ºæ‰€æœ‰çš„æŒ‰é”®ï¼Œä»¥åŠå¯¹åº”çš„å‡½æ•°ã€‚

#+BEGIN_SRC emacs-lisp
(use-package keycast
  :ensure t
  :hook (after-init . keycast-mode)
  :config
  ;; set for doom-modeline support
  ;; With the latest change 72d9add, mode-line-keycast needs to be modified to keycast-mode-line.
  (define-minor-mode keycast-mode
    "Show current command and its key binding in the mode line (fix for use with doom-mode-line)."
    :global t
    (if keycast-mode
        (progn
          (add-hook 'pre-command-hook 'keycast--update t)
          (add-to-list 'global-mode-string '("" keycast-mode-line "  ")))
      (remove-hook 'pre-command-hook 'keycast--update)
      (setq global-mode-string (delete '("" keycast-mode-line "  ") global-mode-string))
      ))

  (dolist (input '(self-insert-command
                   org-self-insert-command))
    (add-to-list 'keycast-substitute-alist `(,input "." "Typingâ€¦")))

  (dolist (event '(mouse-event-p
                   mouse-movement-p
                   mwheel-scroll))
    (add-to-list 'keycast-substitute-alist `(,event nil)))

  (setq keycast-log-format "%-20K%C\n")
  (setq keycast-log-frame-alist
        '((minibuffer . nil)))
  (setq keycast-log-newest-first t)
  )
#+END_SRC

** init-ui.el æ–‡ä»¶å°¾
#+BEGIN_SRC emacs-lisp

(provide 'init-ui)
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;; init-ui.el ends here
#+END_SRC

* init-edit.el
:PROPERTIES:
:HEADER-ARGS: :tangle lisp/init-edit.el :mkdirp yes
:END:

** init-edit.el æ–‡ä»¶å¤´

#+BEGIN_SRC emacs-lisp
;;; init-edit.el --- Editing settings -*- lexical-binding: t -*-
;;; Commentary:

;;; Code:

#+END_SRC

** Emacså¤‡ä»½è®¾ç½®

ä¸ä½¿ç”¨Emacsçš„è‡ªåŠ¨å¤‡ä»½è®¾ç½®ã€‚

#+BEGIN_SRC emacs-lisp
(setq make-backup-files nil)                                  ; ä¸è‡ªåŠ¨å¤‡ä»½
(setq auto-save-default nil)                                  ; ä¸ä½¿ç”¨Emacsè‡ªå¸¦çš„è‡ªåŠ¨ä¿å­˜
#+END_SRC

** è§£é™¤ä¸€äº›ä¸å¸¸ç”¨çš„å¿«æ·é”®

å°†ä¸€äº›ä¸å¸¸ç”¨çš„å¿«æ·é”®è§£é™¤ï¼Œé˜²æ­¢è¯¯æ“ä½œã€‚

#+BEGIN_SRC emacs-lisp
;; è§£é™¤ä¸å¸¸ç”¨çš„å¿«æ·é”®å®šä¹‰
(global-set-key (kbd "C-z") nil)
(global-set-key (kbd "s-q") nil)
(global-set-key (kbd "M-z") nil)
(global-set-key (kbd "M-m") nil)
(global-set-key (kbd "C-x C-z") nil)
(global-set-key [mouse-2] nil)
#+END_SRC

** delselé€‰æ‹©æ–‡æœ¬è¾“å…¥æ—¶ç›´æ¥æ›¿æ¢

Emacsé»˜è®¤é€‰æ‹©æ–‡æœ¬åç›´æ¥è¾“å…¥ï¼Œæ˜¯ä¸ä¼šç›´æ¥åˆ é™¤æ‰€é€‰æ‹©çš„æ–‡æœ¬è¿›è¡Œæ›¿æ¢çš„ã€‚é€šè¿‡å†…ç½®çš„ =delsel= æ’ä»¶æ¥å®ç°è¿™ä¸ªè¡Œä¸ºã€‚

#+begin_src emacs-lisp
;; Directly modify when selecting text
(use-package delsel
  :ensure nil
  :hook (after-init . delete-selection-mode))
#+end_src

** è‡ªåŠ¨é‡è½½è®¾ç½®

å½“æˆ‘ä»¬çš„æ–‡ä»¶å‘ç”Ÿäº†æ”¹å˜åï¼Œæˆ‘ä»¬å¸Œæœ›Emacsé‡Œæ‰“å¼€çš„æ°¸è¿œæ˜¯æœ€æ–°çš„æ–‡ä»¶ï¼Œè¿™ä¸ªæ—¶å€™ï¼Œæˆ‘ä»¬éœ€è¦å¯¹è‡ªåŠ¨é‡è½½è¿›è¡Œè®¾ç½®ï¼Œè®©æˆ‘ä»¬çš„Emacsåœ¨æ–‡ä»¶å‘ç”Ÿæ”¹å˜çš„æ—¶å€™è‡ªåŠ¨é‡è½½æ–‡ä»¶ã€‚

#+BEGIN_SRC emacs-lisp
(use-package autorevert
  :ensure nil
  :hook (after-init . global-auto-revert-mode)
  :bind ("s-u" . revert-buffer)
  :custom
  (auto-revert-interval 10)
  (auto-revert-avoid-polling t)
  (auto-revert-verbose nil)
  (auto-revert-remote-files t)
  (auto-revert-check-vc-info t)
  (global-auto-revert-non-file-buffers t))
#+END_SRC

** avyå…‰æ ‡ç§»åŠ¨

[[https://github.com/abo-abo/avy][avy]] æ˜¯ä¸€ä¸ªå…‰æ ‡ç§»åŠ¨æ’ä»¶ï¼Œèƒ½å¿«é€Ÿå°†å…‰æ ‡ç§»åŠ¨åˆ°å±å¹•ä¸Šçš„ä»»æ„å­—ç¬¦ï¼Œéå¸¸å¼ºå¤§ï¼

#+begin_src emacs-lisp
(use-package avy
  :ensure t
  :bind (("C-." . my/avy-goto-char-timer)
         ("C-ã€‚" . my/avy-goto-char-timer)
         :map isearch-mode-map
         ("C-." . avy-isearch))
  :config
  ;; Make `avy-goto-char-timer' support pinyin, refer to:
  ;; https://emacs-china.org/t/avy-avy-goto-char-timer/20900/2
  (defun my/avy-goto-char-timer (&optional arg)
    "Make avy-goto-char-timer support pinyin"
    (interactive "P")
    (let ((avy-all-windows (if arg
                               (not avy-all-windows)
                             avy-all-windows)))
      (avy-with avy-goto-char-timer
        (setq avy--old-cands (avy--read-candidates
                              'pinyinlib-build-regexp-string))
        (avy-process avy--old-cands))))

  (defun avy-action-kill-whole-line (pt)
    "avy action: kill the whole line where avy selection is"
    (save-excursion
      (goto-char pt)
      (kill-whole-line))
    (select-window
     (cdr
      (ring-ref avy-ring 0)))
    t)

  (defun avy-action-copy-whole-line (pt)
    "avy action: copy the whole line where avy selection is"
    (save-excursion
      (goto-char pt)
      (cl-destructuring-bind (start . end)
          (bounds-of-thing-at-point 'line)
        (copy-region-as-kill start end)))
    (select-window
     (cdr
      (ring-ref avy-ring 0)))
    t)

  (defun avy-action-yank-whole-line (pt)
    "avy action: copy the line where avy selection is and paste to current point"
    (avy-action-copy-whole-line pt)
    (save-excursion (yank))
    t)

  (defun avy-action-teleport-whole-line (pt)
    "avy action: kill the line where avy selection is and paste to current point"
    (avy-action-kill-whole-line pt)
    (save-excursion (yank)) t)

  (defun avy-action-helpful (pt)
    "avy action: get helpful information at point"
    (save-excursion
      (goto-char pt)
      (helpful-at-point))
    ;; (select-window
    ;;  (cdr (ring-ref avy-ring 0)))
    t)

  (defun avy-action-mark-to-char (pt)
    "avy action: mark from current point to avy selection"
    (activate-mark)
    (goto-char pt))

  (defun avy-action-flyspell (pt)
    "avy action: flyspell the word where avy selection is"
    (save-excursion
      (goto-char pt)
      (when (require 'flyspell nil t)
        (flyspell-correct-wrapper))))

  (defun avy-action-define (pt)
    "avy action: define the word in dictionary where avy selection is"
    (save-excursion
      (goto-char pt)
      (fanyi-dwim2)))

  (defun avy-action-embark (pt)
    "avy action: embark where avy selection is"
    (unwind-protect
        (save-excursion
          (goto-char pt)
          (embark-act))
      (select-window
       (cdr (ring-ref avy-ring 0))))
    t)

  (defun avy-action-google (pt)
    "avy action: google the avy selection when it is a word or browse it when it is a link"
    (save-excursion
      (goto-char pt)
      (my/search-or-browse)))

  (setf (alist-get ?k avy-dispatch-alist) 'avy-action-kill-stay
        (alist-get ?K avy-dispatch-alist) 'avy-action-kill-whole-line
        (alist-get ?w avy-dispatch-alist) 'avy-action-copy
        (alist-get ?W avy-dispatch-alist) 'avy-action-copy-whole-line
        (alist-get ?y avy-dispatch-alist) 'avy-action-yank
        (alist-get ?Y avy-dispatch-alist) 'avy-action-yank-whole-line
        (alist-get ?t avy-dispatch-alist) 'avy-action-teleport
        (alist-get ?T avy-dispatch-alist) 'avy-action-teleport-whole-line
        (alist-get ?H avy-dispatch-alist) 'avy-action-helpful
        (alist-get ?  avy-dispatch-alist) 'avy-action-mark-to-char
        (alist-get ?\; avy-dispatch-alist) 'avy-action-flyspell
        (alist-get ?= avy-dispatch-alist) 'avy-action-define
        (alist-get ?o avy-dispatch-alist) 'avy-action-embark
        (alist-get ?G avy-dispatch-alist) 'avy-action-google
        )

  :custom
  ;; (avy-case-fold-search t)              ; default is t
  (avy-timeout-seconds 1.0)
  (avy-all-windows t)
  (avy-background t)
  (avy-keys '(?a ?s ?d ?f ?g ?h ?j ?l ?q ?e ?r ?u ?i ?p ?n))
  )
#+end_src

** multiple-cursorså¤šå…‰æ ‡ç¼–è¾‘
[[https://github.com/magnars/multiple-cursors.el][multiple-cursors]] æ’ä»¶èƒ½è®©Emacså®ç°å¤šå…‰æ ‡ç¼–è¾‘å’Œç§»åŠ¨ã€‚

#+BEGIN_SRC emacs-lisp
(use-package multiple-cursors
  :ensure t
  :bind-keymap ("C-c o" . multiple-cursors-map)
  :bind (("C-`"   . mc/mark-next-like-this)
         ("C-\\"  . mc/unmark-next-like-this)
         :map multiple-cursors-map
              ("SPC" . mc/edit-lines)
              (">"   . mc/mark-next-like-this)
              ("<"   . mc/mark-previous-like-this)
              ("a"   . mc/mark-all-like-this)
              ("n"   . mc/mark-next-like-this-word)
              ("p"   . mc/mark-previous-like-this-word)
              ("r"   . set-rectangular-region-anchor)
              )
  :config
  (defvar multiple-cursors-map nil "keymap for `multiple-cursors")
  (setq multiple-cursors-map (make-sparse-keymap))
  (setq mc/list-file (concat user-emacs-directory "/etc/mc-lists.el"))
  (setq mc/always-run-for-all t)
  )
#+END_SRC

** init-edit.el æ–‡ä»¶å°¾

#+BEGIN_SRC emacs-lisp
;; (message "init-base configuration: %.2fs"
;;          (float-time (time-subtract (current-time) my/init-base-start-time)))

(provide 'init-edit)
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;; init-edit.el ends here
#+END_SRC

* init-org.el
:PROPERTIES:
:HEADER-ARGS: :tangle lisp/init-org.el :mkdirp yes
:END:

** init-org.el æ–‡ä»¶å¤´

#+BEGIN_SRC emacs-lisp
;;; init-org.el --- Org mode settings -*- lexical-binding: t -*-
;;; Commentary:

;;; Code:

#+END_SRC

** Org modeåŸºæœ¬é…ç½®

å¯¹Org modeåŸºæœ¬é…ç½®è¿›è¡Œä¿®æ”¹ã€‚

#+BEGIN_SRC emacs-lisp
(use-package org
  :ensure nil
  :mode ("\\.org\\'" . org-mode)
  :hook ((org-mode . visual-line-mode)
		 (org-mode . my/org-prettify-symbols))
  :commands (org-find-exact-headline-in-buffer org-set-tags)
  :custom-face
  ;; è®¾ç½®Org modeæ ‡é¢˜ä»¥åŠæ¯çº§æ ‡é¢˜è¡Œçš„å¤§å°
  (org-document-title ((t (:height 1.75 :weight bold))))
  (org-level-1 ((t (:height 1.2 :weight bold))))
  (org-level-2 ((t (:height 1.15 :weight bold))))
  (org-level-3 ((t (:height 1.1 :weight bold))))
  (org-level-4 ((t (:height 1.05 :weight bold))))
  (org-level-5 ((t (:height 1.0 :weight bold))))
  (org-level-6 ((t (:height 1.0 :weight bold))))
  (org-level-7 ((t (:height 1.0 :weight bold))))
  (org-level-8 ((t (:height 1.0 :weight bold))))
  (org-level-9 ((t (:height 1.0 :weight bold))))
  ;; è®¾ç½®ä»£ç å—ç”¨ä¸Šä¸‹è¾¹çº¿åŒ…è£¹
  (org-block-begin-line ((t (:underline t :background unspecified))))
  (org-block-end-line ((t (:overline t :underline nil :background unspecified))))
  :config
  ;; ================================
  ;; åœ¨org modeé‡Œç¾åŒ–å­—ç¬¦ä¸²
  ;; ================================
  (defun my/org-prettify-symbols ()
	(setq prettify-symbols-alist
		  (mapcan (lambda (x) (list x (cons (upcase (car x)) (cdr x))))
				  '(
					;; ("[ ]"              . 9744)         ; â˜
					;; ("[X]"              . 9745)         ; â˜‘
					;; ("[-]"              . 8863)         ; âŠŸ
					("#+begin_src"      . 9998)         ; âœ
					("#+end_src"        . 9633)         ; â–¡
					("#+begin_example"  . 129083)       ; ğŸ »
					("#+end_example"    . 129081)       ; ğŸ ¹
					("#+results:"       . 9776)         ; â˜°
					("#+attr_latex:"    . "ğŸ„›")
					("#+attr_html:"     . "ğŸ„—")
					("#+attr_org:"      . "ğŸ„")
					("#+name:"          . "ğŸ„")         ; 127261
					("#+caption:"       . "ğŸ„’")         ; 127250
					("#+date:"          . "ğŸ“…")         ; 128197
					("#+author:"        . "ğŸ’")         ; 128100
					("#+setupfile:"     . 128221)       ; ğŸ“
					("#+email:"         . 128231)       ; ğŸ“§
					("#+startup:"       . 10034)        ; âœ²
					("#+options:"       . 9965)         ; â›­
					("#+title:"         . 10162)        ; â²
					("#+subtitle:"      . 11146)        ; â®Š
					("#+downloaded:"    . 8650)         ; â‡Š
					("#+language:"      . 128441)       ; ğŸ–¹
					("#+begin_quote"    . 187)          ; Â»
					("#+end_quote"      . 171)          ; Â«
                    ("#+begin_results"  . 8943)         ; â‹¯
                    ("#+end_results"    . 8943)         ; â‹¯
					)))
    (setq prettify-symbols-unprettify-at-point t)
	(prettify-symbols-mode 1))

  ;; æå‡latexé¢„è§ˆçš„å›¾ç‰‡æ¸…æ™°åº¦
  (plist-put org-format-latex-options :scale 1.8)

  ;; è®¾ç½®æ ‡é¢˜è¡Œä¹‹é—´æ€»æ˜¯æœ‰ç©ºæ ¼ï¼›åˆ—è¡¨ä¹‹é—´æ ¹æ®æƒ…å†µè‡ªåŠ¨åŠ ç©ºæ ¼
  (setq org-blank-before-new-entry '((heading . t)
									 (plain-list-item . auto)
									 ))

  ;; ======================================
  ;; è®¾ç½®æ‰“å¼€Org linksçš„ç¨‹åº
  ;; ======================================
  (defun my-func/open-and-play-gif-image (file &optional link)
	"Open and play GIF image `FILE' in Emacs buffer.

Optional for Org-mode file: `LINK'."
	(let ((gif-image (create-image file))
		  (tmp-buf (get-buffer-create "*Org-mode GIF image animation*")))
	  (switch-to-buffer tmp-buf)
	  (erase-buffer)
	  (insert-image gif-image)
	  (image-animate gif-image nil t)
	  (local-set-key (kbd "q") 'bury-buffer)
	  ))
  (setq org-file-apps '(("\\.png\\'"     . default)
                        (auto-mode       . emacs)
                        (directory       . emacs)
                        ("\\.mm\\'"      . default)
                        ("\\.x?html?\\'" . default)
                        ("\\.pdf\\'"     . emacs)
                        ("\\.md\\'"      . emacs)
                        ("\\.gif\\'"     . my-func/open-and-play-gif-image)
                        ("\\.xlsx\\'"    . default)
                        ("\\.svg\\'"     . default)
                        ("\\.pptx\\'"    . default)
                        ("\\.docx\\'"    . default)))

  :custom
  ;; è®¾ç½®Org modeçš„ç›®å½•
  (org-directory "~/org")
  ;; è®¾ç½®ç¬”è®°çš„é»˜è®¤å­˜å‚¨ä½ç½®
  (org-default-notes-file (expand-file-name "capture.org" org-directory))
  ;; å¯ç”¨ä¸€äº›å­æ¨¡å—
  (org-modules '(ol-bibtex ol-gnus ol-info ol-eww org-habit org-protocol))
  ;; åœ¨æŒ‰M-RETæ—¶ï¼Œæ˜¯å¦æ ¹æ®å…‰æ ‡æ‰€åœ¨çš„ä½ç½®åˆ†è¡Œï¼Œè¿™é‡Œè®¾ç½®ä¸ºæ˜¯
  ;; (org-M-RET-may-split-line '((default . nil)))
  ;; ä¸€äº›Org modeè‡ªå¸¦çš„ç¾åŒ–è®¾ç½®
  ;; æ ‡é¢˜è¡Œç¾åŒ–
  (org-fontify-whole-heading-line t)
  ;; è®¾ç½®æ ‡é¢˜è¡ŒæŠ˜å ç¬¦å·
  (org-ellipsis " â–¾")
  ;; åœ¨æ´»åŠ¨åŒºåŸŸå†…çš„æ‰€æœ‰æ ‡é¢˜æ æ‰§è¡ŒæŸäº›å‘½ä»¤
  (org-loop-over-headlines-in-active-region t)
  ;; TODOæ ‡ç­¾ç¾åŒ–
  (org-fontify-todo-headline t)
  ;; DONEæ ‡ç­¾ç¾åŒ–
  (org-fontify-done-headline t)
  ;; å¼•ç”¨å—ç¾åŒ–
  (org-fontify-quote-and-verse-blocks t)
  ;; éšè—å®æ ‡è®°
  (org-hide-macro-markers t)
  ;; éšè—å¼ºè°ƒæ ‡ç­¾
  (org-hide-emphasis-markers t)
  ;; é«˜äº®latexè¯­æ³•
  (org-highlight-latex-and-related '(native script entities))
  ;; ä»¥UTF-8æ˜¾ç¤º
  (org-pretty-entities t)
  ;; æ˜¯å¦éšè—æ ‡é¢˜æ çš„å‰ç½®æ˜Ÿå·ï¼Œè¿™é‡Œæˆ‘ä»¬é€šè¿‡org-modernæ¥éšè—
  ;; (org-hide-leading-stars t)
  ;; å½“å¯ç”¨ç¼©è¿›æ¨¡å¼æ—¶è‡ªåŠ¨éšè—å‰ç½®æ˜Ÿå·
  (org-indent-mode-turns-on-hiding-stars t)
  ;; è‡ªåŠ¨å¯ç”¨ç¼©è¿›
  (org-startup-indented nil)
  ;; æ ¹æ®æ ‡é¢˜æ è‡ªåŠ¨ç¼©è¿›æ–‡æœ¬
  (org-adapt-indentation nil)
  ;; è‡ªåŠ¨æ˜¾ç¤ºå›¾ç‰‡
  (org-startup-with-inline-images t)
  ;; é»˜è®¤ä»¥Overviewçš„æ¨¡å¼å±•ç¤ºæ ‡é¢˜è¡Œ
  (org-startup-folded 'overview)
  ;; å…è®¸å­—æ¯åˆ—è¡¨
  (org-list-allow-alphabetical t)
  ;; åˆ—è¡¨çš„ä¸‹ä¸€çº§è®¾ç½®
  (org-list-demote-modify-bullet '(
								   ("-"  . "+")
                                   ("+"  . "1.")
								   ("1." . "a.")
								   ))
  ;; ç¼–è¾‘æ—¶æ£€æŸ¥æ˜¯å¦åœ¨æŠ˜å çš„ä¸å¯è§åŒºåŸŸ
  (org-fold-catch-invisible-edits 'smart)
  ;; åœ¨å½“å‰ä½ç½®æ’å…¥æ–°æ ‡é¢˜è¡Œè¿˜æ˜¯åœ¨å½“å‰æ ‡é¢˜è¡Œåæ’å…¥ï¼Œè¿™é‡Œè®¾ç½®ä¸ºå½“å‰ä½ç½®
  (org-insert-heading-respect-content nil)
  ;; è®¾ç½®å›¾ç‰‡çš„æœ€å¤§å®½åº¦ï¼Œå¦‚æœæœ‰imagemagickæ”¯æŒå°†ä¼šæ”¹å˜å›¾ç‰‡å®é™…å®½åº¦
  ;; å››ç§è®¾ç½®æ–¹æ³•ï¼š(1080), 1080, t, nil
  (org-image-actual-width nil)
  ;; imenuçš„æœ€å¤§æ·±åº¦ï¼Œé»˜è®¤ä¸º2
  (org-imenu-depth 4)
  ;; å›è½¦è¦ä¸è¦è§¦å‘é“¾æ¥ï¼Œè¿™é‡Œè®¾ç½®ä¸è§¦å‘
  (org-return-follows-link nil)
  ;; ä¸Šæ ‡^ä¸‹æ ‡_æ˜¯å¦éœ€è¦ç‰¹æ®Šå­—ç¬¦åŒ…è£¹ï¼Œè¿™é‡Œè®¾ç½®éœ€è¦ç”¨å¤§æ‹¬å·åŒ…è£¹
  (org-use-sub-superscripts '{})
  ;; å¤åˆ¶ç²˜è´´æ ‡é¢˜è¡Œçš„æ—¶å€™åˆ é™¤id
  (org-clone-delete-id t)
  ;; ç²˜è´´æ—¶è°ƒæ•´æ ‡é¢˜è¡Œçš„çº§åˆ«
  (org-yank-adjusted-subtrees t)

  ;; TOODçš„å…³é”®è¯è®¾ç½®ï¼Œå¯ä»¥è®¾ç½®ä¸åŒçš„ç»„
  (org-todo-keywords '((sequence "TODO(t)" "HOLD(h!)" "WIP(i!)" "WAIT(w!)" "|" "DONE(d!)" "CANCELLED(c@/!)")
					   (sequence "REPORT(r)" "BUG(b)" "KNOWNCAUSE(k)" "|" "FIXED(f!)")))
  ;; TODOå…³é”®è¯çš„æ ·å¼è®¾ç½®
  (org-todo-keyword-faces '(("TODO"       :foreground "#7c7c75" :weight bold)
							("HOLD"       :foreground "#feb24c" :weight bold)
							("WIP"        :foreground "#0098dd" :weight bold)
							("WAIT"       :foreground "#9f7efe" :weight bold)
							("DONE"       :foreground "#50a14f" :weight bold)
							("CANCELLED"  :foreground "#ff6480" :weight bold)
							("REPORT"     :foreground "magenta" :weight bold)
							("BUG"        :foreground "red"     :weight bold)
							("KNOWNCAUSE" :foreground "yellow"  :weight bold)
							("FIXED"      :foreground "green"   :weight bold)))
  ;; å½“æ ‡é¢˜è¡ŒçŠ¶æ€å˜åŒ–æ—¶æ ‡ç­¾åŒæ­¥å‘ç”Ÿçš„å˜åŒ–
  ;; Moving a task to CANCELLED adds a CANCELLED tag
  ;; Moving a task to WAIT adds a WAIT tag
  ;; Moving a task to HOLD adds WAIT and HOLD tags
  ;; Moving a task to a done state removes WAIT and HOLD tags
  ;; Moving a task to TODO removes WAIT, CANCELLED, and HOLD tags
  ;; Moving a task to DONE removes WAIT, CANCELLED, and HOLD tags
  (org-todo-state-tags-triggers
   (quote (("CANCELLED" ("CANCELLED" . t))
		   ("WAIT" ("WAIT" . t))
		   ("HOLD" ("WAIT") ("HOLD" . t))
		   (done ("WAIT") ("HOLD"))
		   ("TODO" ("WAIT") ("CANCELLED") ("HOLD"))
		   ("DONE" ("WAIT") ("CANCELLED") ("HOLD")))))
  ;; ä½¿ç”¨ä¸“å®¶æ¨¡å¼é€‰æ‹©æ ‡é¢˜æ çŠ¶æ€
  (org-use-fast-todo-selection 'expert)
  ;; çˆ¶å­æ ‡é¢˜æ çŠ¶æ€æœ‰ä¾èµ–
  (org-enforce-todo-dependencies t)
  ;; æ ‡é¢˜æ å’Œä»»åŠ¡å¤é€‰æ¡†æœ‰ä¾èµ–
  (org-enforce-todo-checkbox-dependencies t)
  ;; ä¼˜å…ˆçº§æ ·å¼è®¾ç½®
  (org-priority-faces '((?A :foreground "red")
						(?B :foreground "orange")
						(?C :foreground "yellow")))
  ;; æ ‡é¢˜è¡Œå…¨å±€å±æ€§è®¾ç½®
  (org-global-properties '(("EFFORT_ALL" . "0:15 0:30 0:45 1:00 2:00 3:00 4:00 5:00 6:00 7:00 8:00")
						   ("APPT_WARNTIME_ALL" . "0 5 10 15 20 25 30 45 60")
						   ("RISK_ALL" . "Low Medium High")
						   ("STYLE_ALL" . "habit")))
  ;; Org columnsçš„é»˜è®¤æ ¼å¼
  (org-columns-default-format "%25ITEM %TODO %SCHEDULED %DEADLINE %3PRIORITY %TAGS %CLOCKSUM %EFFORT{:}")
  ;; å½“çŠ¶æ€ä»DONEæ”¹æˆå…¶ä»–çŠ¶æ€æ—¶ï¼Œç§»é™¤ CLOSED: [timestamp]
  (org-closed-keep-when-no-todo t)
  ;; DONEæ—¶åŠ ä¸Šæ—¶é—´æˆ³
  (org-log-done 'time)
  ;; é‡å¤æ‰§è¡Œæ—¶åŠ ä¸Šæ—¶é—´æˆ³
  (org-log-repeat 'time)
  ;; Deadlineä¿®æ”¹æ—¶åŠ ä¸Šä¸€æ¡è®°å½•
  (org-log-redeadline 'note)
  ;; Scheduleä¿®æ”¹æ—¶åŠ ä¸Šä¸€æ¡è®°å½•
  (org-log-reschedule 'note)
  ;; ä»¥æŠ½å±‰çš„æ–¹å¼è®°å½•
  (org-log-into-drawer t)
  ;; ç´§æ¥ç€æ ‡é¢˜è¡Œæˆ–è€…è®¡åˆ’/æˆªæ­¢æ—¶é—´æˆ³ååŠ ä¸Šè®°å½•æŠ½å±‰
  (org-log-state-notes-insert-after-drawers nil)

  ;; refileä½¿ç”¨ç¼“å­˜
  (org-refile-use-cache t)
  ;; refileçš„ç›®çš„åœ°ï¼Œè¿™é‡Œè®¾ç½®çš„æ˜¯agendaæ–‡ä»¶çš„æ‰€æœ‰æ ‡é¢˜
  (org-refile-targets '((org-agenda-files . (:maxlevel . 9))))
  ;; å°†æ–‡ä»¶ååŠ å…¥åˆ°è·¯å¾„
  (org-refile-use-outline-path 'file)
  ;; æ˜¯å¦æŒ‰æ­¥éª¤refile
  (org-outline-path-complete-in-steps nil)
  ;; å…è®¸åˆ›å»ºæ–°çš„æ ‡é¢˜è¡Œï¼Œä½†éœ€è¦ç¡®è®¤
  (org-refile-allow-creating-parent-nodes 'confirm)

  ;; è®¾ç½®æ ‡ç­¾çš„é»˜è®¤ä½ç½®ï¼Œé»˜è®¤æ˜¯ç¬¬77åˆ—å³å¯¹é½
  ;; (org-tags-column -77)
  ;; è‡ªåŠ¨å¯¹é½æ ‡ç­¾
  (org-auto-align-tags t)
  ;; æ ‡ç­¾ä¸ç»§æ‰¿
  (org-use-tag-inheritance nil)
  ;; åœ¨æ—¥ç¨‹è§†å›¾çš„æ ‡ç­¾ä¸ç»§æ‰¿
  (org-agenda-use-tag-inheritance nil)
  ;; æ ‡ç­¾å¿«é€Ÿé€‰æ‹©
  (org-use-fast-tag-selection t)
  ;; æ ‡ç­¾é€‰æ‹©ä¸éœ€è¦å›è½¦ç¡®è®¤
  (org-fast-tag-selection-single-key t)
  ;; å®šä¹‰äº†æœ‰åºå±æ€§çš„æ ‡é¢˜è¡Œä¹ŸåŠ ä¸Š OREDERD æ ‡ç­¾
  (org-track-ordered-property-with-tag t)
  ;; å§‹ç»ˆå­˜åœ¨çš„çš„æ ‡ç­¾
  (org-tag-persistent-alist '(("read"     . ?r)
							  ("mail"     . ?m)
							  ("emacs"    . ?e)
							  ("study"    . ?s)
							  ("work"     . ?w)))
  ;; é¢„å®šä¹‰å¥½çš„æ ‡ç­¾
  (org-tag-alist '((:startgroup)
				   ("crypt"    . ?c)
				   ("linux"    . ?l)
				   ("apple"    . ?a)
				   ("noexport" . ?n)
				   ("ignore"   . ?i)
				   ("TOC"      . ?t)
				   (:endgroup)))

  ;; å½’æ¡£è®¾ç½®
  (org-archive-location "%s_archive::datetree/")
  )

;; Org modeçš„é™„åŠ åŒ…ï¼Œæœ‰è¯¸å¤šé™„åŠ åŠŸèƒ½
(use-package org-contrib
  :ensure t)
#+END_SRC

** org-modern ç¾åŒ–
ä¸‹é¢ï¼Œæˆ‘ä»¬é€šè¿‡ [[https://github.com/minad/org-modern][org-modern]] æ’ä»¶å¯¹Org modeè¿›è¡Œè¿›ä¸€æ­¥çš„ç¾åŒ–ã€‚

#+BEGIN_SRC emacs-lisp
(use-package org-modern
  :ensure t
  :hook (after-init . (lambda ()
                        (setq org-modern-hide-stars 'leading)
                        (global-org-modern-mode t)))
  :config
  ;; æ ‡é¢˜è¡Œå‹å·å­—ç¬¦
  (setq org-modern-star ["â—‰" "â—‹" "âœ¸" "âœ³" "â—ˆ" "â—‡" "âœ¿" "â€" "âœœ"])
  ;; é¢å¤–çš„è¡Œé—´è·ï¼Œ0.1è¡¨ç¤º10%ï¼Œ1è¡¨ç¤º1px
  (setq-default line-spacing 0.1)
  ;; tagè¾¹æ¡†å®½åº¦ï¼Œè¿˜å¯ä»¥è®¾ç½®ä¸º `auto' å³è‡ªåŠ¨è®¡ç®—
  (setq org-modern-label-border 1)
  ;; è®¾ç½®è¡¨æ ¼ç«–çº¿å®½åº¦ï¼Œé»˜è®¤ä¸º3
  (setq org-modern-table-vertical 2)
  ;; è®¾ç½®è¡¨æ ¼æ¨ªçº¿ä¸º0ï¼Œé»˜è®¤ä¸º0.1
  (setq org-modern-table-horizontal 0)
  ;; å¤é€‰æ¡†ç¾åŒ–
  (setq org-modern-checkbox
        '((?X . #("â–¢âœ“" 0 2 (composition ((2)))))
          (?- . #("â–¢â€“" 0 2 (composition ((2)))))
          (?\s . #("â–¢" 0 1 (composition ((1)))))))
  ;; åˆ—è¡¨ç¬¦å·ç¾åŒ–
  (setq org-modern-list
        '((?- . "â€¢")
          (?+ . "â—¦")
          (?* . "â–¹")))
  ;; ä»£ç å—å·¦è¾¹åŠ ä¸Šä¸€æ¡ç«–è¾¹çº¿ï¼ˆéœ€è¦Org modeé¡¶å¤´ï¼Œå¦‚æœå¯ç”¨äº† `visual-fill-column-mode' ä¼šå¾ˆéš¾çœ‹ï¼‰
  (setq org-modern-block-fringe t)
  ;; ä»£ç å—ç±»å‹ç¾åŒ–ï¼Œæˆ‘ä»¬ä½¿ç”¨äº† `prettify-symbols-mode'
  (setq org-modern-block-name nil)
  ;; #+å…³é”®å­—ç¾åŒ–ï¼Œæˆ‘ä»¬ä½¿ç”¨äº† `prettify-symbols-mode'
  (setq org-modern-keyword nil)
  )
#+END_SRC

** org-appearè‡ªåŠ¨å±•å¼€å¼ºè°ƒé“¾æ¥

é€šè¿‡ [[https://github.com/awth13/org-appear][org-appear]] æ’ä»¶ï¼Œå½“æˆ‘ä»¬çš„å…‰æ ‡ç§»åŠ¨åˆ°Org modeé‡Œçš„å¼ºè°ƒã€é“¾æ¥ä¸Šæ—¶ï¼Œä¼šè‡ªåŠ¨å±•å¼€ï¼Œè¿™æ ·æ–¹ä¾¿è¿›è¡Œç¼–è¾‘ã€‚

#+begin_src emacs-lisp
(use-package org-appear
  :ensure t
  :hook (org-mode . org-appear-mode)
  :config
  (setq org-appear-autolinks t)
  (setq org-appear-autosubmarkers t)
  (setq org-appear-autoentities t)
  (setq org-appear-autokeywords t)
  (setq org-appear-inside-latex t)
  )
#+end_src

** org-auto-tangleè‡ªåŠ¨tangleè®¾ç½®

[[https://github.com/yilkalargaw/org-auto-tangle][org-auto-tangle]] æ’ä»¶å¯ä»¥åœ¨Org modeä¸‹è‡ªåŠ¨è¿›è¡Œtangleã€‚

#+BEGIN_SRC emacs-lisp
(use-package org-auto-tangle
  :ensure t
  :hook (org-mode . org-auto-tangle-mode)
  :config
  (setq org-auto-tangle-default t)
  )
#+END_SRC

** init-org.el æ–‡ä»¶å°¾

#+BEGIN_SRC emacs-lisp

(provide 'init-org)
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;; init-org.el ends here
#+END_SRC

* init-completion.el
:PROPERTIES:
:HEADER-ARGS: :tangle lisp/init-completion.el :mkdirp yes
:END:

Emacsçš„è¡¥å…¨è®¾ç½®ã€‚

** init-completion.el æ–‡ä»¶å¤´
#+BEGIN_SRC emacs-lisp
;;; init-completion.el --- Completion settings -*- lexical-binding: t -*-
;;; Commentary:

;;; Code:

#+END_SRC

** vertico

[[https://github.com/minad/vertico][vertico]] æ’ä»¶æä¾›äº†ä¸€ä¸ªå‚ç›´æ ·å¼çš„è¡¥å…¨ç³»ç»Ÿã€‚

#+BEGIN_SRC emacs-lisp
  (use-package vertico
    :ensure t
    :hook (after-init . vertico-mode)
    :bind (:map minibuffer-local-map
                ("M-<DEL>" . my/minibuffer-backward-kill)
                :map vertico-map
                ("M-q" . vertico-quick-insert)) ; use C-g to exit
    :config
    (defun my/minibuffer-backward-kill (arg)
      "When minibuffer is completing a file name delete up to parent
  folder, otherwise delete a word"
      (interactive "p")
      (if minibuffer-completing-file-name
          ;; Borrowed from https://github.com/raxod502/selectrum/issues/498#issuecomment-803283608
          (if (string-match-p "/." (minibuffer-contents))
              (zap-up-to-char (- arg) ?/)
            (delete-minibuffer-contents))
        (backward-kill-word arg)))

    ;; Do not allow the cursor in the minibuffer prompt
    (setq minibuffer-prompt-properties
          '(read-only t cursor-intangible t face minibuffer-prompt))
    (add-hook 'minibuffer-setup-hook #'cursor-intangible-mode)
    
    (setq vertico-cycle t)                ; cycle from last to first
    :custom
    (vertico-count 15)                    ; number of candidates to display, default is 10
    )
#+END_SRC

** orderless

[[https://github.com/oantolin/orderless][oderless]] æ’ä»¶æä¾›ä¸€ç§æ— åºçš„è¡¥å…¨æ–°å§¿åŠ¿ï¼Œå°†ä¸€ä¸ªæœç´¢çš„èŒƒå¼å˜æˆæ•°ä¸ªä»¥ç©ºæ ¼åˆ†éš”çš„éƒ¨åˆ†ï¼Œå„éƒ¨åˆ†ä¹‹é—´æ²¡æœ‰é¡ºåºï¼Œä½ è¦åšçš„å°±æ˜¯æ ¹æ®è®°å¿†è¾“å…¥å…³é”®è¯ã€ç©ºæ ¼ã€å…³é”®è¯ã€‚

#+BEGIN_SRC emacs-lisp
;; support Pinyin first character match for orderless, avy etc.
(use-package pinyinlib
  :ensure t)

;; orderless æ˜¯ä¸€ç§å“²å­¦æ€æƒ³
(use-package orderless
  :ensure t
  :init
  (setq completion-styles '(orderless partial-completion basic))
  (setq orderless-component-separator "[ &]") ; & is for company because space will break completion
  (setq completion-category-defaults nil)
  (setq completion-category-overrides nil)
  :config
  ;; make completion support pinyin, refer to
  ;; https://emacs-china.org/t/vertico/17913/2
  (defun completion--regex-pinyin (str)
    (orderless-regexp (pinyinlib-build-regexp-string str)))
  (add-to-list 'orderless-matching-styles 'completion--regex-pinyin)
  )
#+END_SRC

** marginalia

[[https://github.com/minad/marginalia][marginalia]] æ’ä»¶ç»™è¿·ä½ ç¼“å†²åŒºçš„è¡¥å…¨å€™é€‰æ¡ç›®æ·»åŠ ä¸€äº›æç¤ºã€‚

#+BEGIN_SRC emacs-lisp
;; minibuffer helpful annotations
(use-package marginalia
  :ensure t
  :hook (after-init . marginalia-mode)
  :custom
  (marginalia-annotators '(marginalia-annotators-heavy marginalia-annotators-light nil)))
#+END_SRC

** consult

[[https://github.com/minad/consult][consult]] æ’ä»¶åŸºäºEmacsè‡ªå¸¦çš„è¡¥å…¨æœºåˆ¶ï¼Œæä¾›äº†ä¸€ç³»åˆ—çš„è¡¥å…¨å‘½ä»¤ã€‚

#+BEGIN_QUOTE
For locate on MacOS:

1. =locate= is not enabled in MacOS by default. We need to enable it via:
   sudo launchctl load -w /System/Library/LaunchDaemons/com.apple.locate.plist

2. Then we need to wait =locate= to build db for the whole file system.

3. If there is something wrong with updating locate db, we can update it manually via:
   chomd 755 ~/Library ~/Downloads ~/Documents ~/Desktop
   sudo /usr/libexec/locate.updatedb
#+END_QUOTE

#+BEGIN_SRC emacs-lisp
  (use-package consult
    :ensure t
    :after org
    :bind (([remap goto-line]                     . consult-goto-line)
           ([remap isearch-forward]               . consult-line-symbol-at-point) ; my-consult-ripgrep-or-line
           ([remap switch-to-buffer]              . consult-buffer)
           ([remap switch-to-buffer-other-window] . consult-buffer-other-window)
           ([remap switch-to-buffer-other-frame]  . consult-buffer-other-frame)
           ([remap yank-pop]                      . consult-yank-pop)
           ([remap apropos]                       . consult-apropos)
           ([remap bookmark-jump]                 . consult-bookmark)
           ([remap goto-line]                     . consult-goto-line)
           ([remap imenu]                         . consult-imenu)
           ([remap multi-occur]                   . consult-multi-occur)
           ([remap recentf-open-files]            . consult-recent-file)
           ("C-x j"                               . consult-mark)
           ("C-c g"                               . consult-ripgrep)
           ("C-c f"                               . consult-find)
           ("\e\ef"                               . consult-locate) ; need to enable locate first
           ("C-c n h"                             . my/consult-find-org-headings)
           :map org-mode-map
           ("C-c C-j"                             . consult-org-heading)
           :map minibuffer-local-map
           ("C-r"                                 . consult-history)
           :map isearch-mode-map
           ("C-;"                                 . consult-line)
           :map prog-mode-map
           ("C-c C-j"                             . consult-outline)
           )
    :hook (completion-list-mode . consult-preview-at-point-mode)
    :init
    ;; Optionally configure the register formatting. This improves the register
    ;; preview for `consult-register', `consult-register-load',
    ;; `consult-register-store' and the Emacs built-ins.
    (setq register-preview-delay 0
          register-preview-function #'consult-register-format)

    ;; Optionally tweak the register preview window.
    ;; This adds thin lines, sorting and hides the mode line of the window.
    (advice-add #'register-preview :override #'consult-register-window)

    ;; Use Consult to select xref locations with preview
    (setq xref-show-xrefs-function #'consult-xref
          xref-show-definitions-function #'consult-xref)

    ;; MacOS locate doesn't support `--ignore-case --existing' args.
    (setq consult-locate-args (pcase system-type
                                ('gnu/linux "locate --ignore-case --existing --regex")
                                ('darwin "mdfind -name")))
    :config
    (consult-customize
     consult-theme
     :preview-key '(:debounce 0.2 any)
     consult-ripgrep consult-git-grep consult-grep
     consult-bookmark consult-recent-file consult-xref
     consult--source-recent-file consult--source-project-recent-file consult--source-bookmark
     :preview-key (kbd "M-."))

    ;; Optionally configure the narrowing key.
    ;; Both < and C-+ work reasonably well.
    (setq consult-narrow-key "<") ;; (kbd "C-+")

    (autoload 'projectile-project-root "projectile")
    (setq consult-project-root-function #'projectile-project-root)

    ;; Use `consult-ripgrep' instead of `consult-line' in large buffers
    (defun consult-line-symbol-at-point ()
      "Consult line the synbol where the point is"
      (interactive)
      (consult-line (thing-at-point 'symbol)))
    )
#+END_SRC

** corfu

[[https://github.com/minad/corfu][corfu]] é€šè¿‡å¼¹çª—è¿›è¡Œè¡¥å…¨ã€‚

#+BEGIN_SRC emacs-lisp
(use-package corfu
  :ensure t
  :hook (after-init . global-corfu-mode)
  :bind
  (:map corfu-map
        ("SPC" . corfu-insert-separator)    ; configure space for separator insertion
        ("M-q" . corfu-quick-complete)      ; use C-g to exit
        ("TAB" . corfu-next)
        ([tab] . corfu-next)
        ("S-TAB" . corfu-previous)
        ([backtab] . corfu-previous))
  :config
  ;; TAB cycle if there are only few candidates
  (setq completion-cycle-threshold 0)
  (setq tab-always-indent 'complete)

  (defun corfu-enable-always-in-minibuffer ()
    "Enable Corfu in the minibuffer if Vertico/Mct are not active."
    (unless (or (bound-and-true-p mct--active)
                (bound-and-true-p vertico--input))
      ;; (setq-local corfu-auto nil) Enable/disable auto completion
      (corfu-mode 1)))
  (add-hook 'minibuffer-setup-hook #'corfu-enable-always-in-minibuffer 1)

  ;; enable corfu in eshell
  (add-hook 'eshell-mode-hook
            (lambda ()
              (setq-local corfu-auto nil)
              (corfu-mode)))

  ;; For Eshell
  ;; ===========
  ;; avoid press RET twice in Eshell
  (defun corfu-send-shell (&rest _)
    "Send completion candidate when inside comint/eshell."
    (cond
     ((and (derived-mode-p 'eshell-mode) (fboundp 'eshell-send-input))
      (eshell-send-input))
     ((and (derived-mode-p 'comint-mode)  (fboundp 'comint-send-input))
      (comint-send-input))))

  (advice-add #'corfu-insert :after #'corfu-send-shell)

  :custom
  (corfu-cycle t)                ;; Enable cycling for `corfu-next/previous'
  )
#+END_SRC

*** cape

[[https://github.com/minad/cape][Cape]] æä¾›äº†ä¸€ç³»åˆ—å¼€ç®±å³ç”¨çš„è¡¥å…¨åç«¯ï¼Œè·Ÿcorfuè”åˆä½¿ç”¨ã€‚

#+BEGIN_SRC emacs-lisp
  (use-package cape
    :ensure t
    :init
    ;; Add `completion-at-point-functions', used by `completion-at-point'.
    (add-to-list 'completion-at-point-functions #'cape-file)
    (add-to-list 'completion-at-point-functions #'cape-dabbrev)
    (add-to-list 'completion-at-point-functions #'cape-keyword)  ; programming language keyword
    (add-to-list 'completion-at-point-functions #'cape-ispell)
    (add-to-list 'completion-at-point-functions #'cape-dict)
    (add-to-list 'completion-at-point-functions #'cape-symbol)   ; elisp symbol
    (add-to-list 'completion-at-point-functions #'cape-line)

    :config
    (setq cape-dict-file (expand-file-name "etc/hunspell_dict.txt" user-emacs-directory))

    ;; for Eshell:
    ;; ===========
    ;; Silence the pcomplete capf, no errors or messages!
    (advice-add 'pcomplete-completions-at-point :around #'cape-wrap-silent)

    ;; Ensure that pcomplete does not write to the buffer
    ;; and behaves as a pure `completion-at-point-function'.
    (advice-add 'pcomplete-completions-at-point :around #'cape-wrap-purify)
    )
#+END_SRC

** yasnippetæ¨¡æ¿è¡¥å…¨

[[https://github.com/joaotavora/yasnippet][yasnippet]] æ’ä»¶æ˜¯ä¸€ä¸ªéå¸¸å¼ºå¤§çš„æ¨¡æ¿è¡¥å…¨ç³»ç»Ÿã€‚

#+begin_src emacs-lisp
;; yasnippet settings
(use-package yasnippet
  :ensure t
  :diminish yas-minor-mode
  :hook ((after-init . yas-reload-all)
         ((prog-mode LaTeX-mode org-mode) . yas-minor-mode))
  :config
  ;; Suppress warning for yasnippet code.
  (require 'warnings)
  (add-to-list 'warning-suppress-types '(yasnippet backquote-change))

  (setq yas-prompt-functions '(yas-x-prompt yas-dropdown-prompt))
  (defun smarter-yas-expand-next-field ()
    "Try to `yas-expand' then `yas-next-field' at current cursor position."
    (interactive)
    (let ((old-point (point))
          (old-tick (buffer-chars-modified-tick)))
      (yas-expand)
      (when (and (eq old-point (point))
                 (eq old-tick (buffer-chars-modified-tick)))
        (ignore-errors (yas-next-field))))))
#+end_src

** init-completion.el æ–‡ä»¶å°¾
#+BEGIN_SRC emacs-lisp

(provide 'init-completion)
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;; init-completion.el ends here
#+END_SRC

* init-tools.el
:PROPERTIES:
:HEADER-ARGS: :tangle lisp/init-tools.el :mkdirp yes
:END:

** init-tools.el æ–‡ä»¶å¤´

#+BEGIN_SRC emacs-lisp
;;; init-tools.el --- Tools settings -*- lexical-binding: t -*-
;;; Commentary: Useful tools to make Emacs efficient!

;;; Code:

#+END_SRC

** helpfulå¸®åŠ©å¢å¼º

[[https://github.com/Wilfred/helpful][helpful]] æ’ä»¶æä¾›äº†å¸®åŠ©å¢å¼ºã€‚

#+begin_src emacs-lisp
(use-package helpful
  :ensure t
  :commands (helpful-callable helpful-variable helpful-command helpful-key helpful-mode)
  :bind (([remap describe-command] . helpful-command)
         ("C-h f" . helpful-callable)
         ("C-h v" . helpful-variable)
         ("C-h s" . helpful-symbol)
         ("C-h S" . describe-syntax)
         ("C-h m" . describe-mode)
         ("C-h F" . describe-face)
         ([remap describe-key] . helpful-key))
  )
#+end_src

** which-keyå¿«æ·é”®

[[https://github.com/justbur/emacs-which-key][which-key]] æ’ä»¶å°†æç¤ºå¿«æ·é”®ã€‚

#+begin_src emacs-lisp
(use-package which-key
  :ensure t
  :hook (after-init . which-key-mode)
  :config
  (which-key-add-key-based-replacements
    "C-c !" "flycheck"
    "C-c @" "hideshow"
    "C-c i" "ispell"
    "C-c t" "hl-todo"
    "C-x a" "abbrev"
    "C-x n" "narrow"
    "C-x t" "tab")
  :custom
  (which-key-idle-delay 0.7)
  (which-key-add-column-padding 1))
#+end_src

** init-tools.el æ–‡ä»¶å°¾

#+BEGIN_SRC emacs-lisp

(provide 'init-tools)
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;;; init-tools.el ends here
#+END_SRC

